{"ast":null,"code":"var _jsxFileName = \"/Users/walesolagbade/streaming_app/client/src/contexts/SocketContext_enhanced.js\",\n  _s = $RefreshSig$(),\n  _s2 = $RefreshSig$();\nimport React, { createContext, useContext, useEffect, useState, useCallback } from 'react';\nimport { io } from 'socket.io-client';\nimport { useAuth } from './AuthContext';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst SocketContext = /*#__PURE__*/createContext();\nexport const useSocket = () => {\n  _s();\n  const context = useContext(SocketContext);\n  if (!context) {\n    throw new Error('useSocket must be used within a SocketProvider');\n  }\n  return context;\n};\n_s(useSocket, \"b9L3QQ+jgeyIrH0NfHrJ8nn7VMU=\");\nexport const SocketProvider = ({\n  children\n}) => {\n  _s2();\n  console.log('ðŸš€ SOCKET PROVIDER: Initializing...');\n  const [socket, setSocket] = useState(null);\n  const [isConnected, setIsConnected] = useState(false);\n  const [currentRoom, setCurrentRoom] = useState(null);\n  const [roomState, setRoomState] = useState(null);\n  const [participants, setParticipants] = useState([]);\n  const [messages, setMessages] = useState([]);\n  const [playbackState, setPlaybackState] = useState({\n    isPlaying: false,\n    currentTrackId: null,\n    currentTime: 0,\n    volume: 0.7,\n    isSynced: true\n  });\n  const {\n    user,\n    token,\n    loading\n  } = useAuth();\n  console.log('ðŸ” SOCKET PROVIDER: Auth state', {\n    hasUser: !!user,\n    hasToken: !!token,\n    loading\n  });\n  useEffect(() => {\n    console.log('ðŸ”Œ SOCKET EFFECT: Checking connection requirements', {\n      hasToken: !!token,\n      hasUser: !!user,\n      userId: user === null || user === void 0 ? void 0 : user.id,\n      currentSocket: !!socket,\n      authLoading: loading\n    });\n\n    // Don't try to connect while auth is still loading\n    if (loading) {\n      console.log('â³ SOCKET: Waiting for auth to finish loading...');\n      return;\n    }\n    if (!token || !user) {\n      console.log('âŒ SOCKET: Missing token or user, setting disconnected state');\n      if (socket) {\n        socket.disconnect();\n        setSocket(null);\n      }\n      setIsConnected(false);\n      return;\n    }\n    console.log('âœ… SOCKET: Creating new connection...');\n\n    // Create socket connection with API URL from environment or default\n    const apiUrl = process.env.REACT_APP_API_URL || 'http://localhost:5002';\n    console.log('ðŸ”Œ SOCKET: Connecting to:', apiUrl);\n    console.log('ðŸ” SOCKET: Using token:', token ? `${token.substring(0, 20)}...` : 'NO TOKEN');\n    console.log('ðŸ‘¤ SOCKET: User:', user ? `${user.username} (ID: ${user.id})` : 'NO USER');\n\n    // Test if token is valid by making a quick API call\n    if (token) {\n      fetch(`${apiUrl}/api/auth/me`, {\n        headers: {\n          'Authorization': `Bearer ${token}`\n        }\n      }).then(response => {\n        console.log('ðŸ” SOCKET: Token validation response:', response.status);\n        return response.json();\n      }).then(data => {\n        console.log('ðŸ” SOCKET: Token validation data:', data);\n      }).catch(error => {\n        console.error('ðŸ” SOCKET: Token validation failed:', error);\n      });\n    }\n    const newSocket = io(apiUrl, {\n      auth: {\n        token: token\n      },\n      transports: ['websocket', 'polling'],\n      timeout: 5000,\n      reconnection: true,\n      reconnectionAttempts: 3,\n      reconnectionDelay: 1000,\n      forceNew: true\n    });\n\n    // Connection event handlers\n    newSocket.on('connect', () => {\n      console.log('âœ… Connected to WebSocket server');\n      setIsConnected(true);\n\n      // If we were trying to join a room, rejoin after reconnection\n      if (currentRoom) {\n        console.log('ðŸ”„ SOCKET: Rejoining room after connection:', currentRoom);\n        newSocket.emit('room:join', currentRoom);\n      }\n    });\n    newSocket.on('connect_error', error => {\n      console.error('âŒ Socket connection error:', error.message);\n      console.error('âŒ Socket connection details:', {\n        type: error.type,\n        description: error.description,\n        context: error.context,\n        serverUrl: apiUrl,\n        hasToken: !!token\n      });\n      setIsConnected(false);\n    });\n    newSocket.on('disconnect', reason => {\n      console.log('ðŸ”Œ Socket disconnected:', reason);\n      setIsConnected(false);\n    });\n\n    // Room event handlers\n    newSocket.on('room:participants-list', participantsList => {\n      console.log('ðŸ“‹ Received participants list:', participantsList);\n      setParticipants(participantsList);\n    });\n    newSocket.on('room:user-joined', data => {\n      console.log('ðŸ‘¤ User joined room:', data.user.username);\n      setParticipants(prev => {\n        if (prev.find(p => p.id === data.user.id)) {\n          return prev; // User already in list\n        }\n        return [...prev, {\n          ...data.user,\n          isHost: data.isHost,\n          joinedAt: data.timestamp\n        }];\n      });\n    });\n    newSocket.on('room:user-left', data => {\n      console.log('ðŸ‘¤ User left room:', data.user.username);\n      setParticipants(prev => prev.filter(p => p.id !== data.user.id));\n    });\n\n    // Synchronized playback event handlers\n    newSocket.on('playback-state-sync', state => {\n      console.log('ðŸ”„ Playback state sync received:', state);\n      setPlaybackState({\n        isPlaying: state.isPlaying,\n        currentTrackId: state.currentTrackId,\n        currentTime: state.currentTime,\n        volume: state.volume,\n        isSynced: true\n      });\n    });\n    newSocket.on('sync-play', data => {\n      console.log('â–¶ï¸ Sync play received:', data);\n      setPlaybackState(prev => ({\n        ...prev,\n        isPlaying: true,\n        currentTrackId: data.trackId || prev.currentTrackId,\n        currentTime: data.currentTime,\n        isSynced: true\n      }));\n    });\n    newSocket.on('sync-pause', data => {\n      console.log('â¸ï¸ Sync pause received:', data);\n      setPlaybackState(prev => ({\n        ...prev,\n        isPlaying: false,\n        currentTime: data.currentTime,\n        isSynced: true\n      }));\n    });\n    newSocket.on('sync-seek', data => {\n      console.log('â­ï¸ Sync seek received:', data);\n      setPlaybackState(prev => ({\n        ...prev,\n        currentTime: data.currentTime,\n        isSynced: true\n      }));\n    });\n    newSocket.on('sync-track-change', data => {\n      console.log('ðŸŽµ Sync track change received:', data);\n      setPlaybackState(prev => ({\n        ...prev,\n        currentTrackId: data.trackId,\n        currentTime: 0,\n        isPlaying: data.autoPlay,\n        isSynced: true\n      }));\n    });\n    newSocket.on('sync-volume-change', data => {\n      console.log('ðŸ”Š Sync volume change received:', data);\n      setPlaybackState(prev => ({\n        ...prev,\n        volume: data.volume,\n        isSynced: true\n      }));\n    });\n\n    // Chat event handlers\n    newSocket.on('room:chat-message', message => {\n      console.log('ðŸ’¬ New message received:', message);\n      setMessages(prev => [...prev, {\n        id: message.id || Date.now(),\n        user: {\n          id: message.userId,\n          username: message.username\n        },\n        message: message.message,\n        timestamp: message.timestamp,\n        type: 'text'\n      }]);\n    });\n    newSocket.on('room:chat-history', history => {\n      console.log('ðŸ“œ Chat history received:', history.length, 'messages');\n      setMessages(history.map(msg => ({\n        id: msg.id,\n        user: {\n          id: msg.userId,\n          username: msg.username\n        },\n        message: msg.message,\n        timestamp: msg.timestamp,\n        type: msg.type || 'text'\n      })));\n    });\n    newSocket.on('error', error => {\n      console.error('Socket error:', error);\n    });\n    setSocket(newSocket);\n\n    // Cleanup function\n    return () => {\n      console.log('ðŸ§¹ SOCKET: Cleaning up connection');\n      newSocket.disconnect();\n    };\n  }, [token, user, loading]);\n\n  // Room management functions\n  const joinRoom = useCallback(async (roomId, userData) => {\n    console.log('ðŸšª JOIN ROOM: Called with', {\n      roomId,\n      userData: userData === null || userData === void 0 ? void 0 : userData.username,\n      hasSocket: !!socket,\n      userDataObj: userData\n    });\n    if (!socket) {\n      console.error('âŒ JOIN ROOM: Cannot join - missing socket');\n      alert('Socket connection not established. Please refresh and try again.');\n      return;\n    }\n    if (!userData || !userData.id || !userData.username) {\n      console.error('âŒ JOIN ROOM: Cannot join - missing or invalid user data', userData);\n      alert('User data missing or invalid. Please re-login.');\n      return;\n    }\n    try {\n      setCurrentRoom(roomId);\n      setParticipants([{\n        id: userData.id,\n        username: userData.username,\n        email: userData.email,\n        isHost: false,\n        joinedAt: new Date().toISOString()\n      }]);\n      console.log('ðŸšª JOIN ROOM: Emitting room:join event for room', roomId);\n      socket.emit('room:join', roomId, ack => {\n        if (ack && ack.error) {\n          console.error('âŒ JOIN ROOM: Server error:', ack.error);\n          alert('Failed to join room: ' + ack.error);\n        } else {\n          console.log('âœ… JOIN ROOM: Successfully joined room', roomId);\n        }\n      });\n    } catch (error) {\n      console.error('âŒ JOIN ROOM: Exception', error);\n      alert('Unexpected error joining room: ' + error.message);\n    }\n  }, [socket]);\n  const leaveRoom = useCallback(() => {\n    if (socket && currentRoom) {\n      console.log(`ðŸšª Leaving room: ${currentRoom}`);\n      socket.emit('room:leave', currentRoom);\n      setCurrentRoom(null);\n      setParticipants([]);\n      setMessages([]);\n      setPlaybackState({\n        isPlaying: false,\n        currentTrackId: null,\n        currentTime: 0,\n        volume: 0.7,\n        isSynced: true\n      });\n    }\n  }, [socket, currentRoom]);\n\n  // Host-only playback controls\n  const hostPlay = useCallback((trackId, currentTime = 0) => {\n    console.log('â–¶ï¸ HOST PLAY: Called with', {\n      trackId,\n      currentTime,\n      hasSocket: !!socket,\n      currentRoom,\n      socketConnected: socket === null || socket === void 0 ? void 0 : socket.connected\n    });\n    if (socket && currentRoom) {\n      console.log('â–¶ï¸ HOST PLAY: Emitting host-play event');\n      socket.emit('host-play', {\n        trackId,\n        currentTime\n      });\n    } else {\n      console.error('ðŸš« HOST PLAY: Cannot emit - missing socket or room', {\n        hasSocket: !!socket,\n        currentRoom,\n        socketConnected: socket === null || socket === void 0 ? void 0 : socket.connected\n      });\n    }\n  }, [socket, currentRoom]);\n  const hostPause = useCallback((currentTime = 0) => {\n    console.log('â¸ï¸ HOST PAUSE: Called with', {\n      currentTime,\n      hasSocket: !!socket,\n      currentRoom,\n      socketConnected: socket === null || socket === void 0 ? void 0 : socket.connected\n    });\n    if (socket && currentRoom) {\n      console.log('â¸ï¸ HOST PAUSE: Emitting host-pause event');\n      socket.emit('host-pause', {\n        currentTime\n      });\n    } else {\n      console.error('ðŸš« HOST PAUSE: Cannot emit - missing socket or room', {\n        hasSocket: !!socket,\n        currentRoom,\n        socketConnected: socket === null || socket === void 0 ? void 0 : socket.connected\n      });\n    }\n  }, [socket, currentRoom]);\n  const hostSeek = useCallback(currentTime => {\n    if (socket && currentRoom) {\n      console.log('â­ï¸ Host seek:', currentTime);\n      socket.emit('host-seek', {\n        currentTime\n      });\n    }\n  }, [socket, currentRoom]);\n  const hostChangeTrack = useCallback((trackId, autoPlay = false) => {\n    console.log('ðŸŽµ HOST CHANGE TRACK: Called with', {\n      trackId,\n      autoPlay,\n      hasSocket: !!socket,\n      currentRoom,\n      socketConnected: socket === null || socket === void 0 ? void 0 : socket.connected,\n      trackIdType: typeof trackId\n    });\n    if (socket && currentRoom) {\n      console.log('ðŸŽµ HOST CHANGE TRACK: Emitting host-change-track event to room', currentRoom);\n      socket.emit('host-change-track', {\n        trackId,\n        autoPlay\n      });\n    } else {\n      console.error('ðŸš« HOST CHANGE TRACK: Cannot emit - missing socket or room', {\n        hasSocket: !!socket,\n        socketConnected: socket === null || socket === void 0 ? void 0 : socket.connected,\n        currentRoom,\n        reason: !socket ? 'no socket' : !currentRoom ? 'no currentRoom' : 'unknown'\n      });\n    }\n  }, [socket, currentRoom]);\n  const hostVolumeChange = useCallback(volume => {\n    if (socket && currentRoom) {\n      console.log('ðŸ”Š Host volume change:', volume);\n      socket.emit('host-volume-change', {\n        volume\n      });\n    }\n  }, [socket, currentRoom]);\n\n  // Request playback sync (for recovering from desync)\n  const requestPlaybackSync = useCallback(() => {\n    if (socket && currentRoom) {\n      console.log('ðŸ”„ Requesting playback sync');\n      socket.emit('request-playback-sync');\n    }\n  }, [socket, currentRoom]);\n\n  // Chat functions\n  const sendMessage = useCallback(message => {\n    if (!socket) {\n      console.error('âŒ SEND MESSAGE: No socket connection.');\n      alert('Cannot send message: No socket connection.');\n      return;\n    }\n    if (!currentRoom) {\n      console.error('âŒ SEND MESSAGE: No current room set.');\n      alert('Cannot send message: Not in a room.');\n      return;\n    }\n    if (!message || typeof message !== 'string' || !message.trim()) {\n      console.error('âŒ SEND MESSAGE: Invalid message content.', message);\n      alert('Cannot send empty message.');\n      return;\n    }\n    const messageData = {\n      roomId: currentRoom,\n      message: message.trim()\n    };\n    console.log('ðŸ’¬ SEND MESSAGE: Emitting room:chat-message', messageData);\n    socket.emit('room:chat-message', messageData, ack => {\n      if (ack && ack.error) {\n        console.error('âŒ SEND MESSAGE: Server error:', ack.error);\n        alert('Failed to send message: ' + ack.error);\n      } else {\n        console.log('âœ… SEND MESSAGE: Message sent successfully.');\n      }\n    });\n  }, [socket, currentRoom]);\n\n  // Participants functions\n  const getParticipants = useCallback(() => {\n    if (socket && currentRoom) {\n      console.log('ðŸ“‹ Requesting participants list for room:', currentRoom);\n      socket.emit('room:get-participants', currentRoom);\n    }\n  }, [socket, currentRoom]);\n\n  // Status update functions\n  const updateStatus = useCallback(status => {\n    if (socket && currentRoom) {\n      socket.emit('update-status', {\n        roomId: currentRoom,\n        ...status\n      });\n    }\n  }, [socket, currentRoom]);\n  const notifyTrackAdded = useCallback(trackData => {\n    if (socket && currentRoom) {\n      socket.emit('track-added', {\n        roomId: currentRoom,\n        track: trackData\n      });\n    }\n  }, [socket, currentRoom]);\n  const value = {\n    socket,\n    isConnected,\n    currentRoom,\n    roomState,\n    participants,\n    messages,\n    playbackState,\n    // Room management\n    joinRoom,\n    leaveRoom,\n    // Host playback controls\n    hostPlay,\n    hostPause,\n    hostSeek,\n    hostChangeTrack,\n    hostVolumeChange,\n    requestPlaybackSync,\n    // Chat\n    sendMessage,\n    // Participants\n    getParticipants,\n    // Other functions\n    updateStatus,\n    notifyTrackAdded\n  };\n  return /*#__PURE__*/_jsxDEV(SocketContext.Provider, {\n    value: value,\n    children: children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 475,\n    columnNumber: 5\n  }, this);\n};\n_s2(SocketProvider, \"l3d2q8H72dgB4gOCl5lGx+ecYcc=\", false, function () {\n  return [useAuth];\n});\n_c = SocketProvider;\nvar _c;\n$RefreshReg$(_c, \"SocketProvider\");","map":{"version":3,"names":["React","createContext","useContext","useEffect","useState","useCallback","io","useAuth","jsxDEV","_jsxDEV","SocketContext","useSocket","_s","context","Error","SocketProvider","children","_s2","console","log","socket","setSocket","isConnected","setIsConnected","currentRoom","setCurrentRoom","roomState","setRoomState","participants","setParticipants","messages","setMessages","playbackState","setPlaybackState","isPlaying","currentTrackId","currentTime","volume","isSynced","user","token","loading","hasUser","hasToken","userId","id","currentSocket","authLoading","disconnect","apiUrl","process","env","REACT_APP_API_URL","substring","username","fetch","headers","then","response","status","json","data","catch","error","newSocket","auth","transports","timeout","reconnection","reconnectionAttempts","reconnectionDelay","forceNew","on","emit","message","type","description","serverUrl","reason","participantsList","prev","find","p","isHost","joinedAt","timestamp","filter","state","trackId","autoPlay","Date","now","history","length","map","msg","joinRoom","roomId","userData","hasSocket","userDataObj","alert","email","toISOString","ack","leaveRoom","hostPlay","socketConnected","connected","hostPause","hostSeek","hostChangeTrack","trackIdType","hostVolumeChange","requestPlaybackSync","sendMessage","trim","messageData","getParticipants","updateStatus","notifyTrackAdded","trackData","track","value","Provider","fileName","_jsxFileName","lineNumber","columnNumber","_c","$RefreshReg$"],"sources":["/Users/walesolagbade/streaming_app/client/src/contexts/SocketContext_enhanced.js"],"sourcesContent":["import React, { createContext, useContext, useEffect, useState, useCallback } from 'react';\nimport { io } from 'socket.io-client';\nimport { useAuth } from './AuthContext';\n\nconst SocketContext = createContext();\n\nexport const useSocket = () => {\n  const context = useContext(SocketContext);\n  if (!context) {\n    throw new Error('useSocket must be used within a SocketProvider');\n  }\n  return context;\n};\n\nexport const SocketProvider = ({ children }) => {\n  console.log('ðŸš€ SOCKET PROVIDER: Initializing...');\n  \n  const [socket, setSocket] = useState(null);\n  const [isConnected, setIsConnected] = useState(false);\n  const [currentRoom, setCurrentRoom] = useState(null);\n  const [roomState, setRoomState] = useState(null);\n  const [participants, setParticipants] = useState([]);\n  const [messages, setMessages] = useState([]);\n  const [playbackState, setPlaybackState] = useState({\n    isPlaying: false,\n    currentTrackId: null,\n    currentTime: 0,\n    volume: 0.7,\n    isSynced: true\n  });\n  const { user, token, loading } = useAuth();\n  \n  console.log('ðŸ” SOCKET PROVIDER: Auth state', { hasUser: !!user, hasToken: !!token, loading });\n\n  useEffect(() => {\n    console.log('ðŸ”Œ SOCKET EFFECT: Checking connection requirements', { \n      hasToken: !!token, \n      hasUser: !!user,\n      userId: user?.id,\n      currentSocket: !!socket,\n      authLoading: loading\n    });\n    \n    // Don't try to connect while auth is still loading\n    if (loading) {\n      console.log('â³ SOCKET: Waiting for auth to finish loading...');\n      return;\n    }\n    \n    if (!token || !user) {\n      console.log('âŒ SOCKET: Missing token or user, setting disconnected state');\n      if (socket) {\n        socket.disconnect();\n        setSocket(null);\n      }\n      setIsConnected(false);\n      return;\n    }\n\n    console.log('âœ… SOCKET: Creating new connection...');\n    \n    // Create socket connection with API URL from environment or default\n    const apiUrl = process.env.REACT_APP_API_URL || 'http://localhost:5002';\n    console.log('ðŸ”Œ SOCKET: Connecting to:', apiUrl);\n    console.log('ðŸ” SOCKET: Using token:', token ? `${token.substring(0, 20)}...` : 'NO TOKEN');\n    console.log('ðŸ‘¤ SOCKET: User:', user ? `${user.username} (ID: ${user.id})` : 'NO USER');\n    \n    // Test if token is valid by making a quick API call\n    if (token) {\n      fetch(`${apiUrl}/api/auth/me`, {\n        headers: {\n          'Authorization': `Bearer ${token}`\n        }\n      })\n      .then(response => {\n        console.log('ðŸ” SOCKET: Token validation response:', response.status);\n        return response.json();\n      })\n      .then(data => {\n        console.log('ðŸ” SOCKET: Token validation data:', data);\n      })\n      .catch(error => {\n        console.error('ðŸ” SOCKET: Token validation failed:', error);\n      });\n    }\n    \n    const newSocket = io(apiUrl, {\n      auth: {\n        token: token\n      },\n      transports: ['websocket', 'polling'],\n      timeout: 5000,\n      reconnection: true,\n      reconnectionAttempts: 3,\n      reconnectionDelay: 1000,\n      forceNew: true\n    });\n\n    // Connection event handlers\n    newSocket.on('connect', () => {\n      console.log('âœ… Connected to WebSocket server');\n      setIsConnected(true);\n      \n      // If we were trying to join a room, rejoin after reconnection\n      if (currentRoom) {\n        console.log('ðŸ”„ SOCKET: Rejoining room after connection:', currentRoom);\n        newSocket.emit('room:join', currentRoom);\n      }\n    });\n\n    newSocket.on('connect_error', (error) => {\n      console.error('âŒ Socket connection error:', error.message);\n      console.error('âŒ Socket connection details:', {\n        type: error.type,\n        description: error.description,\n        context: error.context,\n        serverUrl: apiUrl,\n        hasToken: !!token\n      });\n      setIsConnected(false);\n    });\n\n    newSocket.on('disconnect', (reason) => {\n      console.log('ðŸ”Œ Socket disconnected:', reason);\n      setIsConnected(false);\n    });\n\n    // Room event handlers\n    newSocket.on('room:participants-list', (participantsList) => {\n      console.log('ðŸ“‹ Received participants list:', participantsList);\n      setParticipants(participantsList);\n    });\n\n    newSocket.on('room:user-joined', (data) => {\n      console.log('ðŸ‘¤ User joined room:', data.user.username);\n      setParticipants(prev => {\n        if (prev.find(p => p.id === data.user.id)) {\n          return prev; // User already in list\n        }\n        return [...prev, { ...data.user, isHost: data.isHost, joinedAt: data.timestamp }];\n      });\n    });\n\n    newSocket.on('room:user-left', (data) => {\n      console.log('ðŸ‘¤ User left room:', data.user.username);\n      setParticipants(prev => prev.filter(p => p.id !== data.user.id));\n    });\n\n    // Synchronized playback event handlers\n    newSocket.on('playback-state-sync', (state) => {\n      console.log('ðŸ”„ Playback state sync received:', state);\n      setPlaybackState({\n        isPlaying: state.isPlaying,\n        currentTrackId: state.currentTrackId,\n        currentTime: state.currentTime,\n        volume: state.volume,\n        isSynced: true\n      });\n    });\n\n    newSocket.on('sync-play', (data) => {\n      console.log('â–¶ï¸ Sync play received:', data);\n      setPlaybackState(prev => ({\n        ...prev,\n        isPlaying: true,\n        currentTrackId: data.trackId || prev.currentTrackId,\n        currentTime: data.currentTime,\n        isSynced: true\n      }));\n    });\n\n    newSocket.on('sync-pause', (data) => {\n      console.log('â¸ï¸ Sync pause received:', data);\n      setPlaybackState(prev => ({\n        ...prev,\n        isPlaying: false,\n        currentTime: data.currentTime,\n        isSynced: true\n      }));\n    });\n\n    newSocket.on('sync-seek', (data) => {\n      console.log('â­ï¸ Sync seek received:', data);\n      setPlaybackState(prev => ({\n        ...prev,\n        currentTime: data.currentTime,\n        isSynced: true\n      }));\n    });\n\n    newSocket.on('sync-track-change', (data) => {\n      console.log('ðŸŽµ Sync track change received:', data);\n      setPlaybackState(prev => ({\n        ...prev,\n        currentTrackId: data.trackId,\n        currentTime: 0,\n        isPlaying: data.autoPlay,\n        isSynced: true\n      }));\n    });\n\n    newSocket.on('sync-volume-change', (data) => {\n      console.log('ðŸ”Š Sync volume change received:', data);\n      setPlaybackState(prev => ({\n        ...prev,\n        volume: data.volume,\n        isSynced: true\n      }));\n    });\n\n    // Chat event handlers\n    newSocket.on('room:chat-message', (message) => {\n      console.log('ðŸ’¬ New message received:', message);\n      setMessages(prev => [...prev, {\n        id: message.id || Date.now(),\n        user: {\n          id: message.userId,\n          username: message.username\n        },\n        message: message.message,\n        timestamp: message.timestamp,\n        type: 'text'\n      }]);\n    });\n\n    newSocket.on('room:chat-history', (history) => {\n      console.log('ðŸ“œ Chat history received:', history.length, 'messages');\n      setMessages(history.map(msg => ({\n        id: msg.id,\n        user: {\n          id: msg.userId,\n          username: msg.username\n        },\n        message: msg.message,\n        timestamp: msg.timestamp,\n        type: msg.type || 'text'\n      })));\n    });\n\n    newSocket.on('error', (error) => {\n      console.error('Socket error:', error);\n    });\n\n    setSocket(newSocket);\n\n    // Cleanup function\n    return () => {\n      console.log('ðŸ§¹ SOCKET: Cleaning up connection');\n      newSocket.disconnect();\n    };\n  }, [token, user, loading]);\n\n  // Room management functions\n  const joinRoom = useCallback(async (roomId, userData) => {\n    console.log('ðŸšª JOIN ROOM: Called with', { roomId, userData: userData?.username, hasSocket: !!socket, userDataObj: userData });\n    if (!socket) {\n      console.error('âŒ JOIN ROOM: Cannot join - missing socket');\n      alert('Socket connection not established. Please refresh and try again.');\n      return;\n    }\n    if (!userData || !userData.id || !userData.username) {\n      console.error('âŒ JOIN ROOM: Cannot join - missing or invalid user data', userData);\n      alert('User data missing or invalid. Please re-login.');\n      return;\n    }\n    try {\n      setCurrentRoom(roomId);\n      setParticipants([{\n        id: userData.id,\n        username: userData.username,\n        email: userData.email,\n        isHost: false,\n        joinedAt: new Date().toISOString()\n      }]);\n      console.log('ðŸšª JOIN ROOM: Emitting room:join event for room', roomId);\n      socket.emit('room:join', roomId, (ack) => {\n        if (ack && ack.error) {\n          console.error('âŒ JOIN ROOM: Server error:', ack.error);\n          alert('Failed to join room: ' + ack.error);\n        } else {\n          console.log('âœ… JOIN ROOM: Successfully joined room', roomId);\n        }\n      });\n    } catch (error) {\n      console.error('âŒ JOIN ROOM: Exception', error);\n      alert('Unexpected error joining room: ' + error.message);\n    }\n  }, [socket]);\n\n  const leaveRoom = useCallback(() => {\n    if (socket && currentRoom) {\n      console.log(`ðŸšª Leaving room: ${currentRoom}`);\n      socket.emit('room:leave', currentRoom);\n      setCurrentRoom(null);\n      setParticipants([]);\n      setMessages([]);\n      setPlaybackState({\n        isPlaying: false,\n        currentTrackId: null,\n        currentTime: 0,\n        volume: 0.7,\n        isSynced: true\n      });\n    }\n  }, [socket, currentRoom]);\n\n  // Host-only playback controls\n  const hostPlay = useCallback((trackId, currentTime = 0) => {\n    console.log('â–¶ï¸ HOST PLAY: Called with', {\n      trackId,\n      currentTime,\n      hasSocket: !!socket,\n      currentRoom,\n      socketConnected: socket?.connected\n    });\n    \n    if (socket && currentRoom) {\n      console.log('â–¶ï¸ HOST PLAY: Emitting host-play event');\n      socket.emit('host-play', { trackId, currentTime });\n    } else {\n      console.error('ðŸš« HOST PLAY: Cannot emit - missing socket or room', {\n        hasSocket: !!socket,\n        currentRoom,\n        socketConnected: socket?.connected\n      });\n    }\n  }, [socket, currentRoom]);\n\n  const hostPause = useCallback((currentTime = 0) => {\n    console.log('â¸ï¸ HOST PAUSE: Called with', {\n      currentTime,\n      hasSocket: !!socket,\n      currentRoom,\n      socketConnected: socket?.connected\n    });\n    \n    if (socket && currentRoom) {\n      console.log('â¸ï¸ HOST PAUSE: Emitting host-pause event');\n      socket.emit('host-pause', { currentTime });\n    } else {\n      console.error('ðŸš« HOST PAUSE: Cannot emit - missing socket or room', {\n        hasSocket: !!socket,\n        currentRoom,\n        socketConnected: socket?.connected\n      });\n    }\n  }, [socket, currentRoom]);\n\n  const hostSeek = useCallback((currentTime) => {\n    if (socket && currentRoom) {\n      console.log('â­ï¸ Host seek:', currentTime);\n      socket.emit('host-seek', { currentTime });\n    }\n  }, [socket, currentRoom]);\n\n  const hostChangeTrack = useCallback((trackId, autoPlay = false) => {\n    console.log('ðŸŽµ HOST CHANGE TRACK: Called with', {\n      trackId,\n      autoPlay,\n      hasSocket: !!socket,\n      currentRoom,\n      socketConnected: socket?.connected,\n      trackIdType: typeof trackId\n    });\n    \n    if (socket && currentRoom) {\n      console.log('ðŸŽµ HOST CHANGE TRACK: Emitting host-change-track event to room', currentRoom);\n      socket.emit('host-change-track', { trackId, autoPlay });\n    } else {\n      console.error('ðŸš« HOST CHANGE TRACK: Cannot emit - missing socket or room', {\n        hasSocket: !!socket,\n        socketConnected: socket?.connected,\n        currentRoom,\n        reason: !socket ? 'no socket' : !currentRoom ? 'no currentRoom' : 'unknown'\n      });\n    }\n  }, [socket, currentRoom]);\n\n  const hostVolumeChange = useCallback((volume) => {\n    if (socket && currentRoom) {\n      console.log('ðŸ”Š Host volume change:', volume);\n      socket.emit('host-volume-change', { volume });\n    }\n  }, [socket, currentRoom]);\n\n  // Request playback sync (for recovering from desync)\n  const requestPlaybackSync = useCallback(() => {\n    if (socket && currentRoom) {\n      console.log('ðŸ”„ Requesting playback sync');\n      socket.emit('request-playback-sync');\n    }\n  }, [socket, currentRoom]);\n\n  // Chat functions\n  const sendMessage = useCallback((message) => {\n    if (!socket) {\n      console.error('âŒ SEND MESSAGE: No socket connection.');\n      alert('Cannot send message: No socket connection.');\n      return;\n    }\n    if (!currentRoom) {\n      console.error('âŒ SEND MESSAGE: No current room set.');\n      alert('Cannot send message: Not in a room.');\n      return;\n    }\n    if (!message || typeof message !== 'string' || !message.trim()) {\n      console.error('âŒ SEND MESSAGE: Invalid message content.', message);\n      alert('Cannot send empty message.');\n      return;\n    }\n    const messageData = {\n      roomId: currentRoom,\n      message: message.trim()\n    };\n    console.log('ðŸ’¬ SEND MESSAGE: Emitting room:chat-message', messageData);\n    socket.emit('room:chat-message', messageData, (ack) => {\n      if (ack && ack.error) {\n        console.error('âŒ SEND MESSAGE: Server error:', ack.error);\n        alert('Failed to send message: ' + ack.error);\n      } else {\n        console.log('âœ… SEND MESSAGE: Message sent successfully.');\n      }\n    });\n  }, [socket, currentRoom]);\n\n  // Participants functions\n  const getParticipants = useCallback(() => {\n    if (socket && currentRoom) {\n      console.log('ðŸ“‹ Requesting participants list for room:', currentRoom);\n      socket.emit('room:get-participants', currentRoom);\n    }\n  }, [socket, currentRoom]);\n\n  // Status update functions\n  const updateStatus = useCallback((status) => {\n    if (socket && currentRoom) {\n      socket.emit('update-status', { roomId: currentRoom, ...status });\n    }\n  }, [socket, currentRoom]);\n\n  const notifyTrackAdded = useCallback((trackData) => {\n    if (socket && currentRoom) {\n      socket.emit('track-added', { roomId: currentRoom, track: trackData });\n    }\n  }, [socket, currentRoom]);\n\n  const value = {\n    socket,\n    isConnected,\n    currentRoom,\n    roomState,\n    participants,\n    messages,\n    playbackState,\n    // Room management\n    joinRoom,\n    leaveRoom,\n    // Host playback controls\n    hostPlay,\n    hostPause,\n    hostSeek,\n    hostChangeTrack,\n    hostVolumeChange,\n    requestPlaybackSync,\n    // Chat\n    sendMessage,\n    // Participants\n    getParticipants,\n    // Other functions\n    updateStatus,\n    notifyTrackAdded\n  };\n\n  return (\n    <SocketContext.Provider value={value}>\n      {children}\n    </SocketContext.Provider>\n  );\n};\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}